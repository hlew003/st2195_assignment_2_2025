---
title: "Assignment 2"
output:
  html_document:
    df_print: paged
---
### Load the library

Install the `rvest` package if it is not yet installed
```{r}
if (!("rvest" %in% installed.packages())) {
  install.packages("rvest")
}
library(rvest)
```

### Get the html page

Load in the entire html document
```{r}
sim_html <- read_html("https://www.sim.edu.sg")
sim_html
```

Locate the "contact-item" anchors inside "footer" 
```{r}
sim_nodes <- sim_html %>%
   #html_elements(xpath = '//footer//*[@class="title" or @class="contact-item"]')
  html_elements(xpath = '//footer//div[contains(@class,"contact-item")]//span')
sim_nodes
```

Extract the text within the spans tag
```{r}
sim_text <- sim_nodes %>% html_text()
sim_text
```

Loop through each elements in "sim_text", using "grepl()" for partial comparison.
```{r}

library(stringr)

contact_vec = c()

index <- 1

for (item in sim_text) {
  if (grepl("email",tolower(item))) {
    email <- sim_text[index+1]
    email <- str_trim(email)
    print(email)
    contact_vec = c(contact_vec,email)
  } 
  
  if (grepl("phone",tolower(item))) {
    phone <- sim_text[index+1]
    phone <- str_trim(phone)
    phone <- substr(phone, 1, 9)
    print(phone)
    contact_vec = c(contact_vec,phone)
  }
  
  if (grepl("address",tolower(item))) {
    address <- sim_text[index+1]
    address <- str_trim(address)
    pos <- regexpr("Singapore", address)
    address <- substr(address, 1, pos+15)
    print(address)
    contact_vec = c(contact_vec,address)
  }
  
  index <- index + 1
}
```

Have a look of the contact vector:
```{r}
contact_vec
```

### Save the contact vector into a text file

```{r}
writeLines(contact_vec, "contact.txt")
```

Reload the data from the file to make sure the data was saved properly
```{r}
readLines("contact.txt")
```